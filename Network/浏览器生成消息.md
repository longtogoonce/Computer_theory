# 1.生成HTTP请求消息

## 1.1基本概念
> URL : 统一资源定位符 
> - 网址的开头，如：http  ftp  file
> - 帮助浏览器使用哪种功能访问相应的数据
> - 如：访问Web服务器，使用http

## 1.2.解析URL
> 一般格式：http://www.lab.glasscom.com/dir1/file1/html
> - http :   表示使用协议
> - //  ：  后面跟着服务器的名字
> - /dir1/file1/html : 表示该服务器的文件路径名
>
>  有时会出现省略文件名的情况 :
> - 原因在于该服务器会有默认文件，如：index.html之类的

---

当解析完URL后，我们就知道要访问的目标在哪里，\
接下来浏览器会使用HTTP协议来访问Web服务器

---
## 1.3.HTTP的基本思路
> HTTP :定义了客户端与服务器之间交互的消息内容与步骤\
> 
> 请求消息：
> - 方法：GET POST HEAD……
> > - GET ：获取URI指定的信息，若URI指定文件，则返回该文件信息\
> 如果指定CGI程序，则返回程序的输出数据
> > - POST : 从客户端向服务器发送数据，一般用于写入数据
> - URI ： 访问目标（可以是html文件，也可是CGI程序的文件名）
>
> 响应消息：
> - Web服务器对请求消息进行解析，并将结果放在响应消息中
> - 并在响应消息开头有状态码（404 Not Found就是一种状态码）
>
> 1条请求信息只能写1个URI,如果需要获取多个文件，必须对每个文件单独发送(网页的图片也是一个文件)

---

在委托操作系统发送消息时。需要查询对应服务器的IP地址，而不是其域名

---
\
\
.
# 2.使用DNS服务器查询Web服务器的IP地址

## 2.1IP地址
> 在网络中，所有的设备都会被分配一个IP地址，该地址由网络号与主机号组成
>
>- 集线器：\
> 通过集线器将多台计算机连接在同一个局域网下，使它们可以相互通信和共享资源，这是局域网的基本功能(网络号)
>- 路由器：\
> 如果这个局域网需要与其他不同的局域网或互联网进行通信，就需要使用路由器进行连接和转发数据，从而实现不同局域网之间的通信。路由器能够根据网络地址来判断不同网络之间的数据流向
> 
> 表示方式：
>- IP地址：10.1.2.3
>- 子网掩码：255.255.255.0
>- 含义：\
> 网络号：10.1.2.\
> 主机号：3
> - IP地址的主机号：\
> 全0：表示整个子网\
> 全1(255):表示向子网所有设备发送包
## 2.2调用Socket库
>- Socket库是调用网络功能的程序组件集合
>- Socket库通过提供一系列函数，允许程序员使用TCP/IP协议栈进行网络通信。
>- Socket库可以调用DNS解析函数，比如getaddrinfo()、gethostbyname()等，来解析域名并获取对应的IP地址
>- 当程序使用Socket库的connect()函数建立TCP连接时，它需要提供目标主机的IP地址和端口号。如果程序提供的是域名而不是IP地址，Socket库会使用DNS解析函数将域名解析成IP地址，并将解析结果传递给协议栈，由协议栈向DNS服务器发送查询请求并获取IP地址。最终，Socket库会使用获取到的IP地址建立TCP连接
>- 当调用Socket库中的函数时，操作系统会将请求传递给协议栈来处理。协议栈是操作系统中负责处理网络通信的模块，它实现了TCP/IP协议栈，协议栈会根据请求的内容，使用合适的协议（比如TCP、UDP）来封装数据，然后将数据包发送到目标主机
## 2.3DNS服务器
> 来自客户端的查询消息：
> - 域名：服务器，邮件服务器
> - Class：识别网络，互联网（IN）
> - 记录类型：\
> A : 表示域名是IP地址  
> MX ： 表示域名是邮件服务器
> 
> DNS服务器事先保留有对应的记录信息，通过查找对应符合的内容，返回响应数据
## 2.4域名的层次
> 例如：www.lab.glasscom.com
> - DNS的域名通过句号分割成一个个域
> - 越靠右的位置表示所属层级越高
> - 一个域(com,cn)的信息都是作为一个整体存放在DNS服务器中的，一台DNS服务器可以存放多个域的信息\
com : 商业和商务网站\
.org : 非营利组织\
.net : 网络基础设施和技术公司\
.edu : 教育机构\
.gov : 政府机构\
.cn : 中国
> - 负责管理下一级的域的DNS服务器IP地址会注册到他们上一级的DNS服务器当中
> - 根域为最顶级的域，一般保存在各个DNS服务器当中
> - 访问流程：\
1.首先客户端会访问最近的一台DNS服务器（也就是客户端TCP/IP设置中填写的DNS地址）\
2.如果没有存想要访问的域名地址，就会从根域服务器向下找
> - 有缓存机制加速DNS服务器的访问







## 2.5委托协议栈发送消息
> 在双方建立通信之前，需要建立一条管道，而这一条管道的出入口为套接字
> - 当应用程序创建一个套接字时，它可以绑定到一个特定的 IP 地址和端口号，这样其他计算机就可以通过这个 IP 地址和端口号与之通信
> 收发数据的流程：
> > - 1.创建套接字
> > - 2.将管道连接到服务器端的套接字上
> > - 3.收发数据
> > - 4.断开管道
> - 该流程通过调用Socket库来实现：
> > - 描述符 = socket(<使用IPV4>，<流模式>)
> > - connect = (<描述符>，<服务器的IP地址与端口号>)
> > - write = (<描述符>，<发送数据>，<数据字节长度>)
> - 端口号：
> > - IP地址本质上是分配给设备中安装的网络硬件的，如果一台计算机具有多个网络硬件，那么它就具有多个IP地址\
> > - 而连接操作的对象是某个具体的套接字，所以需要具体到对应的端口号
> - 常见的端口号：
> > - 80：HTTP通信使用的端口号
> > - 443：HTTPS通信使用的端口号
> > - 22：SSH远程登录使用的端口号
> > - 53：DNS域名解析使用的端口号